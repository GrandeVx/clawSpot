"use strict";var p=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var w=Object.prototype.hasOwnProperty;var S=(t,e)=>{for(var o in e)p(t,o,{get:e[o],enumerable:!0})},v=(t,e,o,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of T(e))!w.call(t,r)&&r!==o&&p(t,r,{get:()=>e[r],enumerable:!(s=A(e,r))||s.enumerable});return t};var E=t=>v(p({},"__esModule",{value:!0}),t);var H={};S(H,{nextCookies:()=>U,toNextJsHandler:()=>P});module.exports=E(H);var b=require("next/headers");var R=require("oslo"),_=require("oslo/encoding");var h=require("oslo/crypto");var d=Object.create(null),c=t=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(t?d:globalThis),O=new Proxy(d,{get(t,e){return c()[e]??d[e]},has(t,e){let o=c();return e in o||e in d},set(t,e,o){let s=c(!0);return s[e]=o,!0},deleteProperty(t,e){if(!e)return!1;let o=c(!0);return delete o[e],!0},ownKeys(){let t=c(!0);return Object.keys(t)}});function B(t){return t?t!=="false":!1}var D=typeof process<"u"&&process.env&&process.env.NODE_ENV||"";var $=D==="test"||B(O.TEST);function g(t){let e=new Map;return t.split(", ").forEach(s=>{let r=s.split(";").map(f=>f.trim()),[i,...u]=r,[m,...x]=i.split("="),k=x.join("=");if(!m||k===void 0){console.warn(`Malformed cookie: ${s}`);return}let a={value:k};u.forEach(f=>{let[C,...y]=f.split("="),n=y.join("="),l=C.trim().toLowerCase();switch(l){case"max-age":a["max-age"]=n?parseInt(n.trim(),10):void 0;break;case"expires":a.expires=n?new Date(n.trim()):void 0;break;case"domain":a.domain=n?n.trim():void 0;break;case"path":a.path=n?n.trim():void 0;break;case"secure":a.secure=!0;break;case"httponly":a.httponly=!0;break;case"samesite":a.samesite=n?n.trim().toLowerCase():void 0;break;default:a[l]=n?n.trim():!0;break}}),e.set(m,a)}),e}function P(t){let e=async o=>"handler"in t?t.handler(o):t(o);return{GET:e,POST:e}}var U=()=>({id:"next-cookies",hooks:{after:[{matcher(t){return!0},handler:async t=>{let e=t.responseHeader;if(e instanceof Headers){let o=e?.get("set-cookie");if(!o)return;let s=g(o),r=await(0,b.cookies)();s.forEach((i,u)=>{if(!u)return;let m={sameSite:i.samesite,secure:i.secure,maxAge:i["max-age"],httpOnly:i.httponly,domain:i.domain,path:i.path};try{r.set(u,decodeURIComponent(i.value),m)}catch{if(process.env.NODE_ENV!=="development")return}});return}}}]}});0&&(module.exports={nextCookies,toNextJsHandler});
