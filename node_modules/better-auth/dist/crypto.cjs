"use strict";var U=Object.create;var y=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty;var D=(t,e)=>{for(var r in e)y(t,r,{get:e[r],enumerable:!0})},h=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of E(e))!R.call(t,o)&&o!==r&&y(t,o,{get:()=>e[o],enumerable:!(n=k(e,o))||n.enumerable});return t};var w=(t,e,r)=>(r=t!=null?U(N(t)):{},h(e||!t||!t.__esModule?y(r,"default",{value:t,enumerable:!0}):r,t)),H=t=>h(y({},"__esModule",{value:!0}),t);var z={};D(z,{alphabet:()=>K,byteToBinary:()=>B,bytesToBinary:()=>S,bytesToInteger:()=>f,constantTimeEqual:()=>p,generateRandomInteger:()=>T,generateRandomString:()=>I,hashPassword:()=>P,hs256:()=>L,random:()=>C,symmetricDecrypt:()=>q,symmetricEncrypt:()=>O,verifyPassword:()=>V});module.exports=H(z);var g=require("@noble/ciphers/chacha"),i=require("@noble/ciphers/utils"),l=require("@noble/ciphers/webcrypto"),d=require("oslo/crypto"),u=w(require("uncrypto"),1);function p(t,e){let r=new Uint8Array(t),n=new Uint8Array(e);if(r.length!==n.length)return!1;let o=0;for(let a=0;a<r.length;a++)o|=r[a]^n[a];return o===0}var c=require("oslo/encoding");var A=require("@noble/hashes/scrypt"),x=require("uncrypto"),s={N:16384,r:16,p:1,dkLen:64};async function b(t,e){return await(0,A.scryptAsync)(t.normalize("NFKC"),e,{N:s.N,p:s.p,r:s.r,dkLen:s.dkLen,maxmem:128*s.N*s.r*2})}var P=async t=>{let e=(0,c.encodeHex)((0,x.getRandomValues)(new Uint8Array(16))),r=await b(t,e);return`${e}:${(0,c.encodeHex)(r)}`},V=async(t,e)=>{let[r,n]=t.split(":"),o=await b(e,r);return p(o,(0,c.decodeHex)(n))};var m=w(require("uncrypto"),1);function B(t){return t.toString(2).padStart(8,"0")}function S(t){return[...t].map(e=>B(e)).join("")}function f(t){return parseInt(S(t),2)}function C(){let t=new ArrayBuffer(8),e=m.default.getRandomValues(new Uint8Array(t));return e[0]=63,e[1]=e[1]|240,new DataView(t).getFloat64(0)-1}function T(t){if(t<0||!Number.isInteger(t))throw new Error("Argument 'max' must be an integer greater than or equal to 0");let e=(t-1).toString(2).length,r=e%8,n=new Uint8Array(Math.ceil(e/8));m.default.getRandomValues(n),r!==0&&(n[0]&=(1<<r)-1);let o=f(n);for(;o>=t;)m.default.getRandomValues(n),r!==0&&(n[0]&=(1<<r)-1),o=f(n);return o}function I(t,e){let r="";for(let n=0;n<t;n++)r+=e[T(e.length)];return r}function K(...t){let e=new Set(t),r="";for(let n of e)n==="a-z"?r+="abcdefghijklmnopqrstuvwxyz":n==="A-Z"?r+="ABCDEFGHIJKLMNOPQRSTUVWXYZ":n==="0-9"?r+="0123456789":r+=n;return r}async function L(t,e){let r=new TextEncoder,n={name:"HMAC",hash:"SHA-256"},o=await u.default.subtle.importKey("raw",r.encode(t),n,!1,["sign","verify"]),a=await u.default.subtle.sign(n.name,o,r.encode(e));return btoa(String.fromCharCode(...new Uint8Array(a)))}var O=async({key:t,data:e})=>{let r=await(0,d.sha256)(new TextEncoder().encode(t)),n=(0,i.utf8ToBytes)(e),o=(0,l.managedNonce)(g.xchacha20poly1305)(new Uint8Array(r));return(0,i.bytesToHex)(o.encrypt(n))},q=async({key:t,data:e})=>{let r=await(0,d.sha256)(new TextEncoder().encode(t)),n=(0,i.hexToBytes)(e),o=(0,l.managedNonce)(g.xchacha20poly1305)(new Uint8Array(r));return new TextDecoder().decode(o.decrypt(n))};0&&(module.exports={alphabet,byteToBinary,bytesToBinary,bytesToInteger,constantTimeEqual,generateRandomInteger,generateRandomString,hashPassword,hs256,random,symmetricDecrypt,symmetricEncrypt,verifyPassword});
